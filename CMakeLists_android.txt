# CMake version
cmake_minimum_required (VERSION 2.8)

# project
project (dtutils)

# cross compile
SET(CMAKE_SYSTEM_NAME Linux) 
SET(TOOLCHAIN_DIR "/opt/toolchains/android-ndk-r11c-android-19-arm32-linux-androideabi-4.9")
SET(CMAKE_FIND_ROOT_PATH ${TOOLCHAIN_DIR})
SET(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)
SET(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
SET(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
SET(CMAKE_C_COMPILER ${TOOLCHAIN_DIR}/bin/arm-linux-androideabi-gcc)
SET(CMAKE_CXX_COMPILER ${TOOLCHAIN_DIR}/bin/arm-linux-androideabi-g++)



LIST(APPEND CMAKE_MODULE_PATH "${PROJECT_SOURCE_DIR}")

# DEFS
ADD_DEFINITIONS(-DENABLE_LINUX)
#ADD_DEFINITIONS(-DENABLE_ANDROID)

# target - lib
INCLUDE_DIRECTORIES(include)
AUX_SOURCE_DIRECTORY(src SRC_UTILS)
ADD_LIBRARY(dtutils STATIC ${SRC_UTILS})
#TARGET_LINK_LIBRARIES(dtutils pthread)

# target - test
ADD_EXECUTABLE(test_list test/test_list.c)
TARGET_LINK_LIBRARIES(test_list dtutils)
ADD_EXECUTABLE(test_event test/test_event.c)
TARGET_LINK_LIBRARIES(test_event dtutils)
ADD_EXECUTABLE(test_pool test/test_pool.c)
TARGET_LINK_LIBRARIES(test_pool dtutils)

INSTALL(TARGETS dtutils
    #RUNTIME DESTINATION bin
    LIBRARY DESTINATION lib
    ARCHIVE DESTINATION lib
    )
INSTALL(DIRECTORY include/ DESTINATION /usr/local/include/${PROJECT_NAME})
